<div class="content-forms">
  <div class="form-column">
    <div class="form-calc-graphic">
      <mat-card id="calculator" class="card-design">
        <mat-card-header>
          <mat-card-title>
            <p>Calculadora firulaix</p>
          </mat-card-title>
          <mat-card-subtitle>
            <p>Venta: {{ tipoCambioImp }}</p>
          </mat-card-subtitle>
        </mat-card-header>
        <hr />
        <mat-card-content>
          <form [formGroup]="convertorForm" (submit)="submit()">
            <div class="calc-graphic-camp">
              <div class="camp-from" style="position: relative">
                <button 
                class="border-button" 
                (click)="pasteToSell()"
                style="position: absolute; z-index: 100; top: 25%; right: 2%; padding: .4rem .6rem; background-color: rgba(255, 255, 255, 0.582)">
                  <mat-icon> local_grocery_store</mat-icon>
                </button>

                <div class="border-button select-style">
                  <mat-select formControlName="tipoToken">
                    <mat-option value="USDT" selected>USDT</mat-option>
                    <mat-option value="FIRU" disabled>FIRU</mat-option>
                  </mat-select>
                </div>
                <mat-form-field>
                  <input matInput formControlName="valorIngresado" />
                </mat-form-field>
              </div>
            </div>

            <div class="calc-graphic-camp">
              <div class="camp-from">
                <div class="border-button select-style">
                  <!-- <mat-select formControlName="tipoMoneda">
                    <mat-option value="soles">S/ Soles</mat-option>
                  </mat-select> -->
                  S/ Soles
                </div>

                <mat-form-field>
                  <input
                    type="number"
                    onkeydown="return event.keyCode !== 69"
                    matInput
                    formControlName="resultado"
                    autocomplete="off"
                  />
                </mat-form-field>
              </div>
            </div>
          </form>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="form-text" style="margin-top: 3rem">
      <p>Horarios de atención:</p>
      <div class="form-text-information">
        <p>Lunes a Viernes - 9:00hrs a 18:00hrs</p>
        <p>Sábados - 9:00hrs a 13:00hrs</p>
        <p style="margin-top: 1.5rem">
          * Cualquier colaboración fuera de los horarios establecidos, serán
          atendidos al siguiente día. Si es fin de semana o feriado, se atenderá
          el día hábil más próximo.
        </p>
      </div>
    </div>
  </div>

  <div class="form-column">
    <mat-card class="card-design" id="formulary">
      <mat-card-header>
        <mat-card-title>
          <p>Formulario de Venta</p>
        </mat-card-title>
      </mat-card-header>
      <hr />

      <mat-card-content>
        <form
          (submit)="uploadSell(numTr, bcpAccount, email, tCambio, amount, token)"
          [formGroup]="sendSellFormulary"
        >
          <input
            type="text"
            formControlName="tCambioFormControl"
            #tCambio
            style="display: none"
          />

          <div class="form-register-camp">
            <mat-form-field>
              <input
                type="text"
                onkeydown="return event.keyCode !== 69"
                autocomplete="off"
                matInput
                placeholder="Hash de transacción"
                formControlName="trFormControl"
                #numTr
              />

              <mat-error
                *ngIf="
                  sendSellFormulary.get('trFormControl').invalid &&
                  sendSellFormulary.get('trFormControl').value != 0
                "
              >
                Debe ingresar un hash de transacción válido
              </mat-error>

              <mat-error
                *ngIf="sendSellFormulary.get('trFormControl').value == 0"
              >
                Este campo es requerido
              </mat-error>
            </mat-form-field>

            <div
              class="button-help"
              (click)="openDialogWithRef(infoTransaction)"
            >
              <i class="fas fa-info"></i>
            </div>

            <ng-template #infoTransaction>
              <p matDialogContent class="alert-text">
                Ingrese el número de transacción que figure en su voucher
              </p>

              <mat-dialog-actions align="end">
                <button mat-flat-button color="warn" matDialogClose>
                  Cerrar
                </button>
              </mat-dialog-actions>
            </ng-template>
          </div>

          <div class="form-register-camp">
            <mat-form-field>
              <input
                type="text"
                autocomplete="off"
                matInput
                placeholder="Cuenta de BCP"
                formControlName="bcpAccountFormControl"
                #bcpAccount
              />

              <mat-error
                *ngIf="
                  sendSellFormulary.get('bcpAccountFormControl').invalid &&
                  sendSellFormulary.get('bcpAccountFormControl').value != 0
                "
              >
                Debe ingresar un número de cuenta válido
              </mat-error>

              <mat-error
                *ngIf="
                  sendSellFormulary.get('bcpAccountFormControl').value == 0
                "
              >
                Este campo es requerido
              </mat-error>
            </mat-form-field>

            <div class="button-help" (click)="openDialogWithRef(infoAccount)">
              <i class="fas fa-info"></i>
            </div>

            <ng-template #infoAccount>
              <p matDialogContent class="alert-text">
                ingrese el número de cuenta bcp donde quieras que te lleguen tus
                FIRU's
              </p>

              <mat-dialog-actions align="end">
                <button mat-flat-button color="warn" matDialogClose>
                  Cerrar
                </button>
              </mat-dialog-actions>
            </ng-template>
          </div>

          <div class="form-register-camp">
            <mat-form-field>
              <input
                type="text"
                autocomplete="off"
                matInput
                placeholder="Email"
                formControlName="emailSellFormControl"
                #email
              />
              <mat-error
                *ngIf="
                  sendSellFormulary.get('emailSellFormControl').invalid &&
                  sendSellFormulary.get('emailSellFormControl').value != 0
                "
              >
                Debe ingresar un email válido
              </mat-error>

              <mat-error
                *ngIf="sendSellFormulary.get('emailSellFormControl').value == 0"
              >
                Este campo es requerido
              </mat-error>
            </mat-form-field>

            <div class="button-help" (click)="openDialogWithRef(infoEmail)">
              <i class="fas fa-info"></i>
            </div>

            <ng-template #infoEmail>
              <p matDialogContent class="alert-text">
                Digite un email válido para enviarle la información de la
                transacción de sus FIRU's
              </p>

              <mat-dialog-actions align="end">
                <button mat-flat-button color="warn" matDialogClose>
                  Cerrar
                </button>
              </mat-dialog-actions>
            </ng-template>
          </div>

          <div class="form-register-camp" style="flex-direction: column;">
            <div style="width: 100%; display: grid; grid-template-columns: repeat(2, 1fr); grid-gap: 1rem; padding: 0 4rem;">
              <div style="width: 100%">
                <mat-form-field>
                    <input
                        type="text"
                        autocomplete="off"
                        matInput
                        placeholder="Cantidad"
                        formControlName="amountFormControl"
                        #amount
                      />
                    <mat-error
                      *ngIf="sendSellFormulary.get('amountFormControl').value == 0"
                    >
                      Este campo es requerido
                    </mat-error>
                </mat-form-field>
              </div>
  
  
              <div style="width: 100%">
                <mat-form-field>
                  <input
                        type="text"
                        autocomplete="off"
                        matInput
                        placeholder="Token"
                        formControlName="tokenFormControl"
                        #token
                      />
                </mat-form-field>
              </div>
            </div>
            <div style="padding: 1.5rem 0; color: #ff0000; font-style: italic;">
              <p>* Este monto será tomado como referencia de los montos del cambio y del depósito</p>
            </div>

            <div style="position: absolute; left: 8%; top: 17%; color: #aaaaaa">
              <mat-icon> local_grocery_store</mat-icon>
            </div>

            <div class="button-help" (click)="openDialogWithRef(infoAmountToken)">
              <i class="fas fa-info"></i>
            </div>

            <ng-template #infoAmountToken>
              <p matDialogContent class="alert-text">
                Presione el botón <mat-icon> local_grocery_store</mat-icon> de la calculadora para actualizar estos campos
              </p>

              <mat-dialog-actions align="end">
                <button mat-flat-button color="warn" matDialogClose>
                  Cerrar
                </button>
              </mat-dialog-actions>
            </ng-template>
          </div>

          <div style="margin: 1.5rem 0">
            <p class="text-help">
              Click dentro del recuadro para cargar una foto de tu voucher de
              pago
            </p>
          </div>

          <input
            type="file"
            class="d-none"
            (change)="onPhotoSellSelected($event)"
            accept="image/*"
            formControlName="imageSellFormControl"
            #photoInput
          />

          <div class="image-content">
            <img
              id="imageY"
              [src]="photoSellSelected || 'assets/no-image-2.png'"
              class="img-fluid"
              (click)="photoInput.click()"
            />
          </div>

          <div
            style="
              display: flex;
              align-items: center;
              justify-content: center;
              margin: 2rem 0;
            "
          >
            <re-captcha
              id="recaptcha"
              name="recaptcha"
              formControlName="recaptchaFormControl"
              siteKey="6Lc6xiseAAAAAFYbujSRhuScGJ98qCLIPCUd-i9f"
            ></re-captcha>
          </div>

          <div class="button-formulary">
            <button
              mat-flat-button
              color="accent"
              [disabled]="sendSellFormulary.invalid"
              (click)="openDialogWithRef(RegisterSend)"
            >
              Enviar
            </button>
          </div>

          <ng-template #RegisterSend>
            <div class="popup-width-image">
              <img src="../../../assets/images/popup-firu-2.png" />
            </div>
            <p matDialogContent class="alert-text">
              Gracias por su venta, recibira un email de confirmación.
              <br />
              Revise su bandeja de entrada de lo contrario su bandeja 'spam'.
            </p>

            <mat-dialog-actions align="end">
              <button mat-flat-button color="warn" matDialogClose>
                Cerrar
              </button>
            </mat-dialog-actions>
          </ng-template>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>
